
@{
    ViewBag.Title = "Index";
}

<div class="page-header">
    <h1>Bounty Title</h1> 
    <input id="bountyTitle" class="bountyTitleInput" type="text" name="bountyTitle" placeholder="Enter a title for your bounty"/>
</div>

<div class="row">
    <div class="col-md-8">
        <h1>Background</h1>
        <div class="quill-wrapper">
            <!-- Toolbar for Quill -->
            <div id="background-toolbar" class="toolbar">
                <button class="ql-bold">Bold</button>
                <button class="ql-italic">Italic</button>
            </div>
            <!-- Editor for Quill -->
            <div id="background-editor">
                <div>Hi!</div>
                <div>Add some background about your bug here.</div>
                <div><br></div>
            </div>
        </div>
    </div>
    <div class="col-md-4" >
        <div class="panel panel-default">
            <div class="panel-heading" style="background-color: lightgray">
                <h3><b>Price</b></h3>
            </div>
            <div class="panel-body">
                <input id="bountyPrice" class="bountyPriceInput" type="text" placeholder="Enter a price for your bounty" />
                <h4 style="font-family:Quicksand-Book">You have @ViewData["Coins"] coins available.</h4>
            </div>
        </div>
    </div>
</div>

<div class="row">
    <div class="col-md-8">
        <h1>Task</h1>
        <div class="quill-wrapper">
            <!-- Toolbar for Quill -->
            <div id="task-toolbar" class="toolbar">
                <button class="ql-bold">Bold</button>
                <button class="ql-italic">Italic</button>
            </div>
            <!-- Editor for Quill -->
            <div id="task-editor">
                <div>Hi!</div>
                <div>Define the task for the bounty hunters here.</div>
                <div><br></div>
            </div>
        </div>
        <h1>Code</h1>
        <div class="quill-wrapper">
            <!-- Toolbar for Quill -->
            <div id="code-toolbar" class="toolbar">
                <button class="ql-bold">Bold</button>
                <button class="ql-italic">Italic</button>
            </div>
            <!-- Editor for Quill -->
            <div id="code-editor">
                <div>Hi!</div>
                <div>Copy your code here!</div>
                <div><br></div>
            </div>
        </div>
    </div>
    <div class="col-md-4">
        <div class="panel panel-default">
            <div class="panel-heading" style="background-color: lightgray">
                <h3><b>Time Left</b></h3>
            </div>
            <div class="panel-body" style="align-content:center">
                <input id="bountyEndTime" class="bountyPriceInput" type="date" placeholder="Pick an end time for your bounty." />
            </div>
        </div>
        <div class="panel panel-default">
            <div class="panel-heading" style="background-color: lightgray">
                <h3><b>Tags</b></h3>
            </div>
            <div class="panel-body" style="align-content:center">
                <input id="bountyTags" class="bountyPriceInput" type="text" placeholder="Write tags separated by commas" />
            </div>
        </div>
        <div class="panel panel-default">
            <div class="panel-heading" style="background-color: lightgray">
                <h3><b>Difficulty</b></h3>
            </div>
            <div class="panel-body" style="align-content:center">
                <select id="bountyDifficulty">
                    <option value="Easy">Easy</option>
                    <option value="Medium">Medium</option>
                    <option value="Hard">Hard</option>
                </select>
            </div>
        </div>
    </div>
</div>
<hr/>
<div class="row">
    <div class="col-md-4 col-md-offset-4">
        <div class="find-bounty-container">
            <a id="submitBounty" class="btn btn-success post-bounty-button">Submit</a>
        </div>
    </div>
</div>

<script language="javascript">
    $(document).ready(function () {

        // Create an instance of the background editor
        var backgroundEditor = new Quill('#background-editor', {
            modules: {
                'toolbar': { container: '#background-toolbar' }
            },
            theme: 'snow'
        });

        var taskEditor = new Quill('#task-editor', {
            modules: {
                'toolbar': { container: '#task-toolbar' }
            },
            theme: 'snow'
        });

        var codeEditor = new Quill('#code-editor', {
            modules: {
                'toolbar': { container: '#code-toolbar' }
            },
            theme: 'snow'
        });

        function submitBounty() {
            // Get all the info
            var bountyTitle = $('#bountyTitle').val();
            var bountyBackground = backgroundEditor.getHTML();
            var bountyTask = taskEditor.getHTML();
            var bountyPrice = $('#bountyPrice').val();
            var bountyEndTime = $('#bountyEndTime').val();
            var bountyTags = $('#bountyTags').val().split(',');
            var bountyDifficulty = $('#bountyDifficulty').val();
            var bountyCode = codeEditor.getHTML();

            // Store it in a JSON object
            var bounty = {
                'Title': bountyTitle,
                'Background': bountyBackground,
                'Task': bountyTask,
                'Tags': bountyTags,
                'Price': bountyPrice,
                'Code': bountyCode,
                'EndTime': bountyEndTime,
                'Difficulty': bountyDifficulty
            }

            // Send an AJAX query to the controller
            $.ajax({
                url: '../api/SubmitBountyApi',
                type: 'POST',
                data: JSON.stringify(bounty),
                dataType: 'json',
                contentType: 'application/json',
                success: function (response) {
                    console.log('Web Api Responds with:', response);
                },
                error: function (exception) {
                    alert('Exeption:' + exception);
                }
            });

            // Redirect to Profile
            alert("You've succesfully posted a bounty!")

            window.location.replace('../Profile');
        }

        $('#submitBounty').click(function () {
            submitBounty();
        });

    });
</script>